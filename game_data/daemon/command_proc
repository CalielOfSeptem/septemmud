inherit daemon
d = daemon.new('command_proc')

function f (x)
	print('--- Calling f ---')
	for k, v in pairs(x) do
			print(k, v)
	end
end

function d:process_command (o_orig, cmd )
	if( cmd:len() == 0 ) then
		return false;
	end
	--print('Procsesing command.  EntityType = ' .. o_orig:GetType() .. ', cmd = [' .. cmd .. ']' )
	
	s_type = o_orig:GetType()
	
	if (s_type:lower() == "player" or s_type:lower() == "npc") then
		-- first we search all known global/default commands like "look" and movement commands
		cmds = get_default_commands()
		--print('--- Checking default commands.. ---')
		--f(cmds);
		for k, v in pairs(cmds) do
			if cmd:starts(v:GetCommand():lower()) then -- == cmd then
				--print('Identified command, cmd=' .. v:GetCommand() )
				v:ExecuteCommand( o_orig, cmd )
				return true
			end
			for k1, v1 in pairs(v:GetAliases()) do
				if cmd:starts( v1:lower() ) then
					v:ExecuteCommand( o_orig, cmd )
					return true;
				end
			end
		end
							
		move = get_move_command()
		if move:ExecuteCommand(o_orig, cmd) then
			return true
		end
				
	end
	
	print('I don\'t understand. Type \"help commands\" for more information.') 
end


